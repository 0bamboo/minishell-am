the cases for the env vars :
echo hello$var = hellovar
echo '$var' = $var
echo $var$var = varvar
echo "$var$var" = varvar
echo " \$var" = $var
echo " \$var$var" = $varvar
echo \$var = you are not gonna handle this so the answer should be = \var

the same for :
echo \$var$var = \varvar

first of all you need to look for the $ character and check if you need to look for its value or not (if there is a backslash after it),
then look for the value of the env variable, then you need to claculate the size of each value of that env variables you now what i mean , then concatenate the value of env vars with the string, 

+ you need to handle the env variable before you delete the backslashes, 